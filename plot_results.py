import matplotlib.pyplot as plt

scratch_2d_tr = [4.1406, 2.2145, 1.6613, 1.4608, 1.3239, 1.1622, 0.9897, 0.9135, 0.8584, 0.8152, 0.7736, 0.7404, 0.7163, 0.6909, 0.6791, 0.6650, 0.6436, 0.6290, 0.6145, 0.5956, 0.5843]
scratch_2d_val = [0.0325, 0.0600, 0.0691, 0.0907, 0.1165, 0.1389, 0.1211, 0.1423, 0.1478, 0.1431, 0.1434, 0.1583, 0.1427, 0.1508, 0.1512, 0.1585, 0.1471, 0.1559, 0.1572, 0.1629]
scratch_2d_x = [1, 100, 200, 300, 400, 500, 600, 700, 800, 900, 1000, 1100, 1200, 1300, 1400, 1500, 1600, 1700, 1800, 1900, 2000]

pretrained_2d_tr = [4.3848, 1.1910, 0.3436, 0.2931, 0.2752, 0.2621, 0.2530, 0.2505, 0.2391, 0.2312, 0.2290, 0.2241, 0.2196, 0.2160, 0.2139, 0.2102, 0.2066, 0.2058, 0.2041, 0.2033, 0.2003]
pretrained_2d_val = [0.2703, 0.3187, 0.3284, 0.3125, 0.2965, 0.3320, 0.3165, 0.2973, 0.3473, 0.3435, 0.3279, 0.3410, 0.3552, 0.3473, 0.3547, 0.3558, 0.3580, 0.3530, 0.3675, 0.3671]
pretrained_2d_x = [1, 100, 200, 300, 400, 500, 600, 700, 800, 900, 1000, 1100, 1200, 1300, 1400, 1500, 1600, 1700, 1800, 1900, 2000]

scratch_2d_longer_tr = [4.1499, 1.5588, 0.8817, 0.7165, 0.6522, 0.6063, 0.5565, 0.5361, 0.5182, 0.4963, 0.4723, 0.4587, 0.4480, 0.4396, 0.4329, 0.4230, 0.4182, 0.4123, 0.4051, 0.4002, 0.3970]
scratch_2d_longer_val = [0.0709, 0.1484, 0.1472, 0.1758, 0.1822, 0.2152, 0.2208, 0.2239, 0.2296, 0.2525, 0.2525, 0.2544, 0.2521, 0.2656, 0.2684, 0.2609, 0.2710, 0.2639, 0.2653, 0.2692]
scratch_2d_longer_x = [1, 500, 1000, 1500, 2000, 2500, 3000, 3500, 4000, 4500, 5000, 5500, 6000, 6500, 7000, 7500, 8000, 8500, 9000, 9500, 10000]

pretrained_3d_tr = [5.9727, 3.1452, 2.6860, 2.3893, 2.1718, 2.0590, 1.9760, 1.9339, 1.8241, 1.7848, 1.7474, 1.6635, 1.6425, 1.5816, 1.5164, 1.5156, 1.5054, 1.4359, 1.4328, 1.3786, 1.3948]
pretrained_3d_val = [0.0367, 0.0458, 0.0506, 0.0790, 0.0679, 0.0978, 0.0753, 0.0852, 0.1063, 0.0920, 0.1226, 0.1062, 0.1230, 0.1266, 0.1441, 0.1427, 0.1424, 0.1452, 0.1509, 0.1532]
pretrained_3d_x = [1, 100, 200, 300, 400, 500, 600, 700, 800, 900, 1000, 1100, 1200, 1300, 1400, 1500, 1600, 1700, 1800, 1900, 2000]

pretrained_3d_no_bf16_tr = [4.0902, 2.3928, 2.0257, 1.8098, 1.6501, 1.4478, 1.3114, 1.1980, 1.1214, 1.0227, 1.0003, 0.9535, 0.8973, 0.8819, 0.8375, 0.8135, 0.8006, 0.7799, 0.7653, 0.7535, 0.7502]
pretrained_3d_no_bf16_val = [0.0531, 0.0466, 0.0443, 0.0604, 0.0990, 0.0831, 0.1061, 0.1158, 0.1307, 0.1302, 0.1352, 0.1542, 0.1537, 0.1676, 0.1631, 0.1793, 0.1743, 0.1805, 0.1840, 0.1854]
pretrained_3d_no_bf16_x = [1, 100, 200, 300, 400, 500, 600, 700, 800, 900, 1000, 1100, 1200, 1300, 1400, 1500, 1600, 1700, 1800, 1900, 2000]

scratch_3d_no_bf16_tr = [4.0687, 2.7302, 2.4241, 2.3710, 2.2436, 2.0446, 1.9401, 1.8424, 1.7718, 1.6638, 1.6104, 1.5832, 1.5370, 1.4854, 1.4416, 1.4058, 1.3853, 1.3615, 1.3386, 1.3237, 1.2939]
scratch_3d_no_bf16_val = [0.0119, 0.0291, 0.0288, 0.0211, 0.0562, 0.0502, 0.0577, 0.0475, 0.0605, 0.0563, 0.0506, 0.0601, 0.0627, 0.0683, 0.0756, 0.0659, 0.0732, 0.0747, 0.0778, 0.0720]
scratch_3d_no_bf16_x = [1, 100, 200, 300, 400, 500, 600, 700, 800, 900, 1000, 1100, 1200, 1300, 1400, 1500, 1600, 1700, 1800, 1900, 2000]

# Organize into a list of tuples to iterate
models = [
    ('pretrained_2d', pretrained_2d_tr, pretrained_2d_val, pretrained_2d_x, '#56B4E9'),
    ('scratch_2d', scratch_2d_tr, scratch_2d_val, scratch_2d_x, '#E69F00'),
    ('scratch_2d_longer', scratch_2d_longer_tr, scratch_2d_longer_val, scratch_2d_longer_x, '#009E73'),
    ('pretrained_3d', pretrained_3d_tr, pretrained_3d_val, pretrained_3d_x, '#F0E442'),
    ('pretrained_3d_no_bf16', pretrained_3d_no_bf16_tr, pretrained_3d_no_bf16_val, pretrained_3d_no_bf16_x, '#0072B2'),
    ('scratch_3d_no_bf16', scratch_3d_no_bf16_tr, scratch_3d_no_bf16_val, scratch_3d_no_bf16_x, '#D55E00')
]

fig, (ax1, ax2) = plt.subplots(1, 2, figsize=(14, 6))

for idx, (name, tr, val, x, c) in enumerate(models):
    # Plot training metrics with all x values
    ax1.plot(x, tr, label=name, color=c, linewidth=2)
    # Plot validation metrics excluding the first iteration (x[1:])
    ax2.plot(x[1:], val, label=name, color=c, linewidth=2)

# Training Subplot
ax1.set_xlabel('Iterations')
ax1.set_ylabel('Training Loss')
ax1.set_ylim([0, 4])
ax1.set_xlim([0, 10000])
ax1.grid(True, linestyle='--', alpha=0.6)
ax1.legend(frameon=False)

# Validation Subplot
ax2.set_xlabel('Iterations')
ax2.set_ylabel('Validation mIoU')
ax2.set_ylim([0, 0.4])
ax2.set_xlim([0, 10000])
ax2.grid(True, linestyle='--', alpha=0.6)
ax2.legend(frameon=False)

plt.tight_layout()
plt.savefig('metrics.png', dpi=300)